<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Wikipedia Dump</title>
</head>
<body>
    <h2>Download Wikipedia Dump</h2>
    <p>Click the button below to choose a location and download the latest Wikipedia dump file.</p>
    <button id="downloadBtn">Download File</button>

    <script>
        async function downloadFile() {
            const fileUrl = "https://dumps.wikimedia.org/enwiki/latest/enwiki-latest-pages-articles.xml.bz2";
            
            // Fetch file data
            const response = await fetch(fileUrl);
            if (!response.ok) {
                alert("Failed to fetch file!");
                return;
            }
            const fileData = await response.blob();  // Convert response to a Blob
            
            // Prompt user to select a save location
            try {
                const handle = await window.showSaveFilePicker({
                    suggestedName: "enwiki-latest-pages-articles.xml.bz2",
                    types: [{
                        description: "BZ2 Compressed File",
                        accept: { "application/x-bzip2": [".bz2"] }
                    }]
                });
                
                // Create writable file and save data
                const writable = await handle.createWritable();
                await writable.write(fileData);
                await writable.close();
                alert("Download completed successfully!");
            } catch (error) {
                console.error("File save cancelled or failed:", error);
            }
        }

        document.getElementById("downloadBtn").addEventListener("click", downloadFile);
    </script>
</body>
</html>
